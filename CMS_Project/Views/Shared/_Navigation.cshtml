@using CMS_Project.Models;
@{
    var db = new CMSDataContext();
    var Items = db.MenuItems.ToArray();
    //IList<MenuItem> Items=new List<MenuItem>();
    //if (db.MenuItems > 0 ) {
    //    Items = db.MenuItems.ToArray();
    //}
}

<script type="text/javascript">
    
    function AddToList(itmName, itmID,PerentID,isSubMenu) {
        debugger;
        var ParentItm = document.getElementById("Parent_" + PerentID);
        
        if (!ParentItm) {
            var div = document.getElementById("itm_"+PerentID);
            if(isSubMenu==1){
                div.className+="dropdown-submenu";
                div.innerHTML+='<i class="fa fa-angle-right"></i>';
            }
            else
                div.className +='dropdown';
            div.innerHTML += '<ul class="dropdown-menu" id="Parent_' + PerentID + '"></ul>';
            ParentItm = document.getElementById("Parent_" + PerentID);
        }
        ParentItm.innerHTML += '<li id="itm_'+itmID+'"><a href="#">'+itmName+'</a></li>';
    }
</script>

<div class="header-navigation pull-right font-transform-inherit" id="nav">
    <ul>
        @if (Items != null)
        {
            for (int i = 0; i < Items.Count(); i++)
            {
                if (Items[i].Parent == null)
                {
                    <li class="" id="itm_@Items[i].ID">
                        <a class="dropdown-toggle" data-toggle="dropdown" data-target="#" href="javascript:;">
                            @Items[i].Name
                        </a>
                    </li>
                }
                else
                {
                    int sub=0;
                    if (Items[i].Parent.Parent != null)
                    {
                        sub = 1;
                    }
                    <script type="text/javascript">AddToList("@Items[i].Name",@Items[i].ID,@Items[i].Parent.ID,@sub);</script>

                }
            }
        }
    </ul>
</div>
